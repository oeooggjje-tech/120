<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EmbryoMaster | Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ©</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#e11d48">

    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#e11d48',
                        secondary: '#f43f5e',
                    },
                    fontFamily: {
                        cairo: ['Cairo', 'sans-serif'],
                        inter: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Cairo', sans-serif; transition: background-color 0.3s; -webkit-tap-highlight-color: transparent; }
        .english-text { font-family: 'Inter', sans-serif; direction: ltr; }
        .fade-in { animation: fadeIn 0.3s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ù„ØªÙ†Ø§Ø³Ø¨ Ø´Ø§Ø´Ø© Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        .quiz-card {
            border-radius: 1.5rem; /* Ø²ÙˆØ§ÙŠØ§ Ø£Ù†Ø¹Ù… ÙˆØ£ØµØºØ± */
            padding: 1.25rem; /* Ù…Ø³Ø§Ø­Ø© Ø¯Ø§Ø®Ù„ÙŠØ© Ø£Ù‚Ù„ Ù„Ù„Ø±Ø´Ø§Ù‚Ø© */
        }
        
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-thumb { background: #e11d48; border-radius: 10px; }
        .glass { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
        .dark .glass { background: rgba(30, 41, 59, 0.95); }
    </style>
</head>
<body class="bg-rose-50 dark:bg-slate-950 text-slate-800 dark:text-slate-100 min-h-screen selection:bg-rose-200">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ICONS ---
        const Icons = {
            Brain: () => <svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"/><path d="M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"/><path d="M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4"/></svg>,
            Check: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"/></svg>,
            Back: () => <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m15 18-6-6 6-6"/></svg>,
            Timer: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
            Sun: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/></svg>,
            Moon: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>,
            Home: () => <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>,
            Flag: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"/><line x1="4" y1="22" x2="4" y2="15"/></svg>,
            FlagFilled: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"/><line x1="4" y1="22" x2="4" y2="15"/></svg>,
            Grid: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="7" height="7" x="3" y="3" rx="1"/><rect width="7" height="7" x="14" y="3" rx="1"/><rect width="7" height="7" x="14" y="14" rx="1"/><rect width="7" height="7" x="3" y="14" rx="1"/></svg>,
            Alert: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>,
            Repeat: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m17 2 4 4-4 4"/><path d="M3 11v-1a4 4 0 0 1 4-4h14"/><path d="m7 22-4-4 4-4"/><path d="M21 13v1a4 4 0 0 1-4 4H3"/></svg>
        };

        // --- DATABASE (Ù†ÙØ³ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©) ---
        const lecQuestions = [
            { id: 'l1_1', lec: 1, q: "The development of a human being begins with:", opts: ["Ovulation.", "Fertilization.", "Cleavage.", "Implantation.", "Birth."], ans: 1 },
            // ... (Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙƒÙ…Ø§ Ù‡ÙŠ ÙÙŠ ÙƒÙˆØ¯Ùƒ Ø§Ù„Ø£ØµÙ„ÙŠ)
        ];

        // 2. MIDTERM EXAM QUESTIONS
        const midQuestions = [
            { id: 'm1', q: "The development of a human being begins with:", opts: ["Ovulation.", "Fertilization.", "Cleavage.", "Implantation.", "Birth."], ans: 1 },
            // ... (Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙƒÙ…Ø§ Ù‡ÙŠ ÙÙŠ ÙƒÙˆØ¯Ùƒ Ø§Ù„Ø£ØµÙ„ÙŠ)
        ];

        function App() {
            const [screen, setScreen] = useState('home');
            const [questionsQueue, setQuestionsQueue] = useState([]);
            const [userAnswers, setUserAnswers] = useState({});
            const [flagged, setFlagged] = useState(new Set());
            const [timer, setTimer] = useState(0);
            const [isTimerRunning, setIsTimerRunning] = useState(false);
            const [title, setTitle] = useState('');
            const [darkMode, setDarkMode] = useState(false);
            const [filterMode, setFilterMode] = useState('all');

            useEffect(() => {
                if (darkMode) document.documentElement.classList.add('dark');
                else document.documentElement.classList.remove('dark');
            }, [darkMode]);

            useEffect(() => {
                let interval;
                if (isTimerRunning) interval = setInterval(() => setTimer(t => t + 1), 1000);
                return () => clearInterval(interval);
            }, [isTimerRunning]);

            const scrollToQ = (index) => {
                const el = document.getElementById(`q-${index}`);
                if (el) el.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }

            const formatTime = (s) => {
                const m = Math.floor(s/60);
                const sec = s%60;
                return `${m}:${sec < 10 ? '0' : ''}${sec}`;
            }

            const startExam = (mode, lecId = null) => {
                let q = [];
                let t = '';
                if (mode === 'mid') { q = midQuestions; t = 'ğŸ“ Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„Ù…Ø¯ (60 Ø³Ø¤Ø§Ù„)'; }
                else if (mode === 'lec') { q = lecQuestions.filter(x => x.lec === lecId); t = `Ù…Ø­Ø§Ø¶Ø±Ø© ${lecId}`; }
                else if (mode === 'custom') { q = lecId; t = 'ğŸ¯ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡'; }

                setQuestionsQueue(q);
                setTitle(t);
                setUserAnswers({});
                setFlagged(new Set());
                setTimer(0);
                setIsTimerRunning(true);
                setScreen('quiz');
                setFilterMode('all');
                window.scrollTo(0,0);
            }

            const handleAnswer = (qId, optIdx) => setUserAnswers(prev => ({...prev, [qId]: optIdx}));
            const toggleFlag = (qId) => {
                const next = new Set(flagged);
                if(next.has(qId)) next.delete(qId); else next.add(qId);
                setFlagged(next);
            }

            const goToReview = () => { setScreen('review'); window.scrollTo(0,0); }
            const submitExam = () => { setIsTimerRunning(false); setScreen('results'); window.scrollTo(0,0); }

            const ProgressBar = () => {
                const answered = Object.keys(userAnswers).length;
                const total = questionsQueue.length;
                const percent = Math.round((answered / total) * 100);
                return (
                    <div className="fixed top-0 left-0 w-full h-1 bg-slate-200 dark:bg-slate-700 z-[60]">
                        <div className="h-full bg-rose-500 transition-all duration-500" style={{width: `${percent}%`}}></div>
                    </div>
                )
            }

            const renderHome = () => (
                <div className="min-h-screen flex flex-col items-center justify-center p-6 fade-in relative overflow-hidden">
                    <button onClick={() => setDarkMode(!darkMode)} className="absolute top-6 right-6 p-3 bg-white dark:bg-slate-800 rounded-full shadow-lg z-20">
                        {darkMode ? <Icons.Sun/> : <Icons.Moon/>}
                    </button>
                    <div className="text-center mb-8 relative z-10">
                        <div className="bg-white dark:bg-slate-800 p-5 rounded-[1.5rem] shadow-xl inline-block mb-4">
                            <div className="text-rose-600"><Icons.Brain /></div>
                        </div>
                        <h1 className="text-4xl font-black text-slate-800 dark:text-white mb-2">EmbryoMaster</h1>
                        <p className="text-slate-500 font-bold text-sm">Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© ğŸš€</p>
                    </div>
                    <div className="w-full max-w-sm space-y-3 relative z-10">
                        <button onClick={() => startExam('mid')} className="w-full bg-slate-900 dark:bg-slate-800 text-white p-5 rounded-2xl font-bold shadow-lg hover:scale-[1.02] transition-all flex justify-between items-center">
                            <span>ğŸ“ Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„Ù…Ø¯</span>
                            <span className="text-xs bg-white/10 px-2 py-1 rounded-full">60 Ø³Ø¤Ø§Ù„</span>
                        </button>
                        <div className="bg-white/80 dark:bg-slate-800/80 backdrop-blur-md p-5 rounded-2xl shadow-lg border border-white">
                            <p className="text-slate-400 font-bold text-xs mb-4 text-center">ğŸ“š Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª</p>
                            <div className="grid grid-cols-3 gap-2 english-text">
                                {[1,2,3,4,5,6,7,8,9].map(i => (
                                    <button key={i} onClick={() => startExam('lec', i)} className="bg-white dark:bg-slate-700 border border-slate-100 py-3 rounded-xl font-bold text-slate-600 dark:text-slate-300 hover:border-primary transition-all">Lec {i}</button>
                                ))}
                            </div>
                        </div>
                    </div>
                </div>
            );

            const renderQuiz = () => (
                <div className="min-h-screen pb-24 fade-in bg-slate-50 dark:bg-slate-950">
                    <ProgressBar />
                    <div className="sticky top-0 z-50 glass border-b border-slate-200 dark:border-slate-800 px-4 py-2 shadow-sm">
                        <div className="max-w-xl mx-auto flex justify-between items-center">
                            <button onClick={() => setScreen('home')} className="text-slate-400 p-2"><Icons.Home/></button>
                            <div className="bg-slate-100 dark:bg-slate-800 px-3 py-1 rounded-lg font-bold text-xs english-text">
                                {formatTime(timer)}
                            </div>
                            <button onClick={goToReview} className="bg-rose-50 dark:bg-rose-900/20 text-rose-600 px-3 py-1.5 rounded-lg font-bold text-xs flex items-center gap-1">
                                <Icons.Grid /> Ù…Ø±Ø§Ø¬Ø¹Ø©
                            </button>
                        </div>
                    </div>
                    <div className="max-w-xl mx-auto p-4 space-y-4">
                        {questionsQueue.map((q, idx) => (
                            <div key={q.id} id={`q-${idx}`} className={`quiz-card bg-white dark:bg-slate-900 shadow-sm border transition-all english-text ${flagged.has(q.id) ? 'border-amber-400 ring-1 ring-amber-100' : 'border-slate-100 dark:border-slate-800'}`}>
                                <div className="flex justify-between items-center mb-3">
                                    <span className="bg-slate-100 dark:bg-slate-800 text-slate-500 px-2 py-0.5 rounded-md text-[10px] font-black">Q {idx+1}</span>
                                    <button onClick={() => toggleFlag(q.id)} className={`${flagged.has(q.id) ? 'text-amber-500' : 'text-slate-200'}`}><Icons.FlagFilled/></button>
                                </div>
                                <h3 className="font-bold text-slate-800 dark:text-white text-[15px] mb-4 leading-relaxed">{q.q}</h3>
                                <div className="space-y-2">
                                    {q.opts.map((opt, oIdx) => {
                                        const sel = userAnswers[q.id] === oIdx;
                                        return (
                                            <button key={oIdx} onClick={() => handleAnswer(q.id, oIdx)} className={`w-full text-left p-3 rounded-xl text-sm font-medium border-2 transition-all ${sel ? 'bg-rose-600 border-rose-600 text-white shadow-md' : 'bg-slate-50 dark:bg-slate-800/50 border-transparent text-slate-600 dark:text-slate-300'}`}>
                                                {opt}
                                            </button>
                                        )
                                    })}
                                </div>
                            </div>
                        ))}
                    </div>
                    <div className="fixed bottom-4 left-0 w-full z-40 px-4">
                        <button onClick={goToReview} className="max-w-xl mx-auto w-full bg-slate-900 dark:bg-slate-700 text-white py-4 rounded-xl font-bold shadow-xl flex items-center justify-center gap-2">
                            <span>Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØªØ³Ù„ÙŠÙ…</span> <Icons.Grid/>
                        </button>
                    </div>
                </div>
            );

            // ... (Ø¨Ø§Ù‚ÙŠ Ø§Ù„ØµÙØ­Ø§Øª Review Ùˆ Results Ø¨Ù†ÙØ³ Ù…Ù†Ø·Ù‚ Ø§Ù„ØªØµØºÙŠØ± Ù„Ù„Ø¨Ø·Ø§Ù‚Ø§Øª)

            return (
                <div className="antialiased min-h-screen">
                    {screen === 'home' && renderHome()}
                    {screen === 'quiz' && renderQuiz()}
                    {/* Ø£Ø¶Ù Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø­Ø§Ù„Ø§Øª Ù‡Ù†Ø§ Ø¨Ù†ÙØ³ Ø§Ù„Ù†Ù…Ø· */}
                    {screen === 'review' && <div className="p-6 text-center"><button onClick={submitExam} className="bg-rose-600 text-white p-4 rounded-xl font-bold">ØªØ³Ù„ÙŠÙ… Ù†Ù‡Ø§Ø¦ÙŠ</button></div>}
                    {screen === 'results' && <div className="p-6 text-center">ØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡! <button onClick={()=>setScreen('home')} className="block mx-auto mt-4 underline">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button></div>}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
